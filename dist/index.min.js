!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.dtnClient=e():t.dtnClient=e()}(window,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){var n=r(1);t.exports={GamClient:n}},function(t,e){var r=document.createElement("div");function n(t){(t=t||{}).addScript=void 0===t.addScript||t.addScript,t.loadEvent=void 0!==t.loadEvent?t.loadEvent:"sv-adloaded",t.attrs=void 0!==t.attrs?t.attrs:{},t.attrs.adcomplete=void 0!==t.attrs.complete?t.attrs.complete:"data-sv-adcomplete",t.attrs.adunit=void 0!==t.attrs.adunit?t.attrs.adunit:"data-sv-adunit",t.attrs.adrecid=void 0!==t.attrs.adrecid?t.attrs.adrecid:"data-sv-adrecid",t.attrs.adsize=void 0!==t.attrs.adsize?t.attrs.adsize:"data-sv-adsize",t.attrs.adstyle=void 0!==t.attrs.adstyle?t.attrs.adstyle:"data-sv-adstyle",t.attrs.adclick=void 0!==t.attrs.adclick?t.attrs.adclick:"data-sv-adclick",t.attrs.adclickcapture=void 0!==t.attrs.adclickcapture?t.attrs.adclickcapture:"data-sv-adclickcapture",function(t){!0===t&&(e=document,n="script",a=e.getElementsByTagName(n)[0],(i=e.createElement(n)).async=!0,i.src="//www.googletagservices.com/tag/js/gpt.js",a.parentNode.insertBefore(i,a));var e,n,a,i;window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[],window.googletag.cmd.push(function(){window.googletag.pubads().enableSingleRequest(),window.googletag.enableServices(),window.googletag.pubads().addEventListener("slotRenderEnded",function(t){var e=document.createEvent("CustomEvent");e.initCustomEvent("slotRenderEnded-"+t.slot.getSlotElementId(),!0,!0),r.dispatchEvent(e)})})}(t.addScript),this._c=Math.floor(1e5*Math.random()),this._getAdTile=0,this._slotId=0,this._args=t,this._attrs=t.attrs}function a(t){var e=document.createElement("img");e.src=t,e.style.display="none",document.querySelector("body").appendChild(e)}function i(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r]);return e}n.prototype.renderAds=function(){var t=this,e=document.querySelectorAll("["+t._attrs.adunit+"]:not(["+t._attrs.adcomplete+"])");(e=i(e)).forEach(function(e,n){e.setAttribute(t._attrs.adcomplete,""),""===e.id&&(e.id="sv-ad-"+t._slotId++);var d={id:e.id,adunit:e.getAttribute(t._attrs.adunit),adrecid:e.getAttribute(t._attrs.adrecid),adsize:e.getAttribute(t._attrs.adsize),adstyle:e.getAttribute(t._attrs.adstyle)||"iframe",adclickcapture:e.getAttribute(t._attrs.adclickcapture),template:e.innerHTML};if("iframe"===d.adstyle){if(null===d.adsize)return console.error("Adunit '"+d.adunit+"' requires "+t._attrs.adsize+".");var o=d.adsize.split("x").map(function(t){return Number(t)});window.googletag.cmd.push(function(){var n=window.googletag.defineSlot(d.adunit,o,d.id);if(null!==n){n=n.addService(window.googletag.pubads());var a=function(n){t._dispatchEvent(e,{adSlot:d}),r.removeEventListener(i,a,!1)},i="slotRenderEnded-"+d.id;r.addEventListener(i,a,!1),window.googletag.display(d.id)}})}else if("html"===d.adstyle){if(null===d.adsize)return console.error("Adunit '"+d.adunit+"' requires "+t._attrs.adsize+".");t.getAd({adunit:d.adunit,size:d.adsize},function(r,n){if(r)return console.error(r);e.innerHTML=n,t._dispatchEvent(e,{adSlot:d,data:n})})}else if("template"===d.adstyle){if(null===d.adsize)return console.error("Adunit '"+d.adunit+"' requires "+t._attrs.adsize+".");t.getAd({adunit:d.adunit,size:d.adsize},function(r,n){if(r)return console.error(r);if(0!==n.length){var i=JSON.parse(n);if(void 0===i.impressionUrl)return console.error("Template adunit '"+d.adunit+"' requires an 'impressionUrl' in it's creative.");a(i.impressionUrl);var o=d.template;for(var s in i)o=o.replace(new RegExp("{{"+s+"}}","g"),i[s]);o=o.replace(/<\/?template>/g,""),e.innerHTML=o,t._dispatchEvent(e,{adSlot:d,data:i})}})}else if("recid"===d.adstyle){if(null===d.adrecid)return console.error("Adunit '"+d.adunit+"' requires "+t._attrs.adrecid+".");t.getAd({adunit:d.adunit,size:"1x1",targeting:"recid="+d.adrecid},function(r,n){if(r)return console.error(r);if(0!==n.length){for(var o=JSON.parse(n),s=["recid","impressionUrl","clickUrl"],l=0;l<s.length;l++){var c=s[l];if(void 0===o[c]||"string"!=typeof o[c]||0===o[c].length)return console.error("Featured listing ad templates require a valid '"+c+"'")}a(o.impressionUrl);var u=e.querySelectorAll("["+t._attrs.adclick+"]");if((u=i(u)).forEach(function(t){var e=t.getAttribute("href");if(null!==e)return null===e.match(/^https?:\/\//)?console.error("Unable to track non-absolute url '"+e+"'."):void t.setAttribute("href",o.clickUrl+e)}),null!==e.adclickcapture){var p=function(t){var r;r=o.clickUrl,navigator.sendBeacon?function(t){navigator.sendBeacon(t)}(r):a(r),e.removeEventListener("click",p,!0)};e.addEventListener("click",p,!0)}t._dispatchEvent(e,{adSlot:d,data:o})}})}})},n.prototype.getAd=function(t,e){if(void 0===(t=t||{}).adunit||void 0===t.size)return e(new Error("getAd requires args.adunit and args.size"));var r="";void 0!==t.targeting&&(r="&t="+encodeURIComponent(t.targeting));var n=new XMLHttpRequest,a="https://pubads.g.doubleclick.net/gampad/adx?iu="+encodeURIComponent(t.adunit)+"&sz="+encodeURIComponent(t.size)+"&c="+this._c+"&tile="+this._getAdTile+++r;n.open("GET",a),n.onload=function(){return 200===n.status?e(null,n.responseText):e(new Error("GAM returned '"+n.status+"' status code."))},n.send()},n.prototype._dispatchEvent=function(t,e){var r=document.createEvent("CustomEvent");r.initCustomEvent(this._args.loadEvent,!0,!0,e),t.dispatchEvent(r)},t.exports=n}])});